<!DOCTYPE html> <html> <head> <meta name="google-site-verification" content="WDIfE7e2k7-qW611nc197Z8TmPPZCXlRlD-h-uMht-8"/><meta name="msvalidate.01" content=""/> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>some git stuff to remember | Nasib A. Naimi</title> <meta name="author" content="Nasib A. Naimi"/> <meta name="description" content="solutions to tricky git situations and advanced git operations that are easy to forget"/> <meta name="keywords" content="Nasib, Naimi, engineer, machine learning, reinforcement learning, signal processing, information theory, autonomous robots, drones, computer vision, eth zurich"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¦™</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://nasibnaimi.com/blog/2024/git-pain/"> <title>some git stuff to remember | blank</title> <meta name="generator" content="Jekyll v4.3.4"/> <meta property="og:title" content="some git stuff to remember"/> <meta name="author" content="Nasib Naimi"/> <meta property="og:locale" content="en"/> <meta name="description" content="solutions to tricky git situations and advanced git operations that are easy to forget"/> <meta property="og:description" content="solutions to tricky git situations and advanced git operations that are easy to forget"/> <link rel="canonical" href="https://nasibnaimi.com/blog/2024/git-pain/"/> <meta property="og:url" content="https://nasibnaimi.com/blog/2024/git-pain/"/> <meta property="og:site_name" content="blank"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2024-03-20T00:00:00+00:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="some git stuff to remember"/> <meta name="google-site-verification" content="WDIfE7e2k7-qW611nc197Z8TmPPZCXlRlD-h-uMht-8"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nasib Naimi"},"dateModified":"2024-03-20T00:00:00+00:00","datePublished":"2024-03-20T00:00:00+00:00","description":"solutions to tricky git situations and advanced git operations that are easy to forget","headline":"some git stuff to remember","mainEntityOfPage":{"@type":"WebPage","@id":"https://nasibnaimi.com/blog/2024/git-pain/"},"url":"https://nasibnaimi.com/blog/2024/git-pain/"}</script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <d-front-matter> <script async type="text/json">{
      "title": "some git stuff to remember",
      "description": "solutions to tricky git situations and advanced git operations that are easy to forget",
      "published": "March 20, 2024",
      "authors": [
        {
          "author": "Nasib Naimi",
          "authorURL": "",
          "affiliations": [
            {
              "name": "ETH Zurich",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">NasibÂ </span>A.Â Naimi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">notes<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/recipes/">recipes</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>some git stuff to remember</h1> <p>solutions to tricky git situations and advanced git operations that are easy to forget</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#history-manipulation">History Manipulation</a></div> <div><a href="#recovery-operations">Recovery Operations</a></div> <div><a href="#advanced-workflows">Advanced Workflows</a></div> <div><a href="#git-hooks-and-automation">Git Hooks and Automation</a></div> <div><a href="#submodules-and-subtrees">Submodules and Subtrees</a></div> </nav> </d-contents> <h2 id="history-manipulation">History Manipulation</h2> <h3 id="interactive-rebase-operations">Interactive Rebase Operations</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Rewrite multiple commits</span>
git rebase <span class="nt">-i</span> HEAD~5  <span class="c"># Last 5 commits</span>

<span class="c"># Common operations:</span>
<span class="c"># fixup - combine with previous commit, discard message</span>
<span class="c"># squash - combine with previous, keep both messages</span>
<span class="c"># reword - change commit message</span>
<span class="c"># drop - remove commit entirely</span>
<span class="c"># edit - stop for amending</span>

<span class="c"># Force push with lease (safer than force push)</span>
git push <span class="nt">--force-with-lease</span>  <span class="c"># Fails if remote has new commits</span>
</code></pre></div></div> <h3 id="cherry-picking-and-patching">Cherry-picking and Patching</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cherry-pick specific commits</span>
git cherry-pick &lt;commit-hash&gt;  <span class="c"># Single commit</span>
git cherry-pick &lt;hash1&gt;..&lt;hash2&gt;  <span class="c"># Range of commits</span>

<span class="c"># Create patch files</span>
git format-patch <span class="nt">-1</span> HEAD  <span class="c"># Last commit</span>
git format-patch <span class="nt">-n</span> &lt;commit&gt;  <span class="c"># Last n commits</span>
git format-patch master..feature  <span class="c"># Branch differences</span>

<span class="c"># Apply patches</span>
git apply <span class="nt">--check</span> my.patch  <span class="c"># Test if patch applies</span>
git am &lt; my.patch  <span class="c"># Apply patch with commit info</span>
</code></pre></div></div> <h2 id="recovery-operations">Recovery Operations</h2> <h3 id="recovering-lost-work">Recovering Lost Work</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Find lost commits (after reset --hard)</span>
git reflog
git checkout <span class="nt">-b</span> recovery-branch &lt;<span class="nb">hash</span><span class="o">&gt;</span>

<span class="c"># Recover deleted branch</span>
git reflog | <span class="nb">grep</span> <span class="nt">-A</span> 1 <span class="s1">'to &lt;branch-name&gt;'</span>
git checkout <span class="nt">-b</span> &lt;branch-name&gt; &lt;<span class="nb">hash</span><span class="o">&gt;</span>

<span class="c"># Recover stashed changes</span>
git fsck <span class="nt">--unreachable</span> | <span class="nb">grep </span>commit | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f3</span> | xargs git show
</code></pre></div></div> <h3 id="advanced-reset-operations">Advanced Reset Operations</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reset specific paths</span>
git reset <span class="nt">--hard</span> origin/master <span class="nt">--</span> path/to/file

<span class="c"># Clean working directory but keep specific files</span>
git stash <span class="nt">--keep-index</span>
git stash drop

<span class="c"># Unstage parts of a file</span>
git reset <span class="nt">-p</span> HEAD &lt;file&gt;
</code></pre></div></div> <h2 id="advanced-workflows">Advanced Workflows</h2> <h3 id="bisect-for-bug-hunting">Bisect for Bug Hunting</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git bisect start
git bisect bad  <span class="c"># Current commit is broken</span>
git bisect good &lt;commit&gt;  <span class="c"># Last known good commit</span>

<span class="c"># Automate with test script</span>
git bisect run ./test-script.sh

<span class="c"># After finding the culprit</span>
git bisect reset
</code></pre></div></div> <h3 id="worktrees-for-multiple-checkouts">Worktrees for Multiple Checkouts</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create new worktree</span>
git worktree add ../path/to/folder branch-name

<span class="c"># List worktrees</span>
git worktree list

<span class="c"># Remove worktree</span>
git worktree remove ../path/to/folder
</code></pre></div></div> <h3 id="advanced-merge-strategies">Advanced Merge Strategies</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Recursive strategy with options</span>
git merge <span class="nt">-X</span> ignore-space-change feature
git merge <span class="nt">-X</span> theirs feature  <span class="c"># Prefer their changes</span>
git merge <span class="nt">-X</span> patience feature  <span class="c"># Better handling of renamed files</span>

<span class="c"># Octopus merge (multiple branches)</span>
git merge branch1 branch2 branch3
</code></pre></div></div> <h2 id="git-hooks-and-automation">Git Hooks and Automation</h2> <h3 id="advanced-pre-commit-configuration">Advanced Pre-commit Configuration</h3> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .pre-commit-config.yaml</span>
<span class="na">default_language_version</span><span class="pi">:</span>
    <span class="na">python</span><span class="pi">:</span> <span class="s">python3.9</span>
<span class="na">default_stages</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">commit</span><span class="pi">,</span> <span class="nv">push</span><span class="pi">]</span>
<span class="na">fail_fast</span><span class="pi">:</span> <span class="kc">true</span>

<span class="na">repos</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">repo</span><span class="pi">:</span> <span class="s">local</span>
    <span class="na">hooks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">custom-script</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">Custom Validation</span>
        <span class="na">entry</span><span class="pi">:</span> <span class="s">./scripts/validate.sh</span>
        <span class="na">language</span><span class="pi">:</span> <span class="s">script</span>
        <span class="na">files</span><span class="pi">:</span> <span class="s">\\.py$</span>
        <span class="na">stages</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">commit</span><span class="pi">]</span>
        <span class="na">additional_dependencies</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">pytest'</span><span class="pi">]</span>

  <span class="pi">-</span> <span class="na">repo</span><span class="pi">:</span> <span class="s">https://github.com/psf/black</span>
    <span class="na">rev</span><span class="pi">:</span> <span class="s">22.10.0</span>
    <span class="na">hooks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">black</span>
        <span class="na">args</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">--check'</span><span class="pi">]</span>
        <span class="na">exclude</span><span class="pi">:</span> <span class="s">^(venv/|docs/)</span>

  <span class="pi">-</span> <span class="na">repo</span><span class="pi">:</span> <span class="s">https://github.com/pre-commit/mirrors-mypy</span>
    <span class="na">rev</span><span class="pi">:</span> <span class="s">v0.982</span>
    <span class="na">hooks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">mypy</span>
        <span class="na">additional_dependencies</span><span class="pi">:</span> 
          <span class="pi">-</span> <span class="s1">'</span><span class="s">types-requests'</span>
          <span class="pi">-</span> <span class="s1">'</span><span class="s">types-PyYAML'</span>
</code></pre></div></div> <h3 id="custom-git-hooks">Custom Git Hooks</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># .git/hooks/pre-push</span>

<span class="nv">protected_branches</span><span class="o">=(</span><span class="s1">'main'</span> <span class="s1">'master'</span> <span class="s1">'production'</span><span class="o">)</span>
<span class="nv">current_branch</span><span class="o">=</span><span class="si">$(</span>git symbolic-ref HEAD | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s,.*/\(.*\),\1,'</span><span class="si">)</span>

<span class="k">for </span>branch <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">protected_branches</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    if</span> <span class="o">[[</span> <span class="nv">$current_branch</span> <span class="o">=</span> <span class="nv">$branch</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">read</span> <span class="nt">-p</span> <span class="s2">"You're about to push to </span><span class="nv">$branch</span><span class="s2">, is that what you intended? [y|n] "</span> <span class="nt">-n</span> 1 <span class="nt">-r</span> &lt; /dev/tty
        <span class="nb">echo
        </span><span class="k">if </span><span class="nb">echo</span> <span class="nv">$REPLY</span> | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s1">'^[Nn]$'</span> <span class="o">&gt;</span> /dev/null<span class="p">;</span> <span class="k">then
            </span><span class="nb">exit </span>1
        <span class="k">fi
    fi
done
</span><span class="nb">exit </span>0
</code></pre></div></div> <h2 id="submodules-and-subtrees">Submodules and Subtrees</h2> <h3 id="advanced-submodule-operations">Advanced Submodule Operations</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Update specific submodule to latest</span>
git submodule update <span class="nt">--remote</span> <span class="nt">--merge</span> specific-submodule

<span class="c"># Execute command in each submodule</span>
git submodule foreach <span class="s1">'git checkout -b feature'</span>

<span class="c"># Remove a submodule</span>
git submodule deinit <span class="nt">-f</span> path/to/submodule
git <span class="nb">rm</span> <span class="nt">-f</span> path/to/submodule
<span class="nb">rm</span> <span class="nt">-rf</span> .git/modules/path/to/submodule
</code></pre></div></div> <h3 id="git-subtree-alternative-to-submodules">Git Subtree (Alternative to Submodules)</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add subtree</span>
git subtree add <span class="nt">--prefix</span><span class="o">=</span>lib/core https://github.com/org/lib.git master

<span class="c"># Update subtree</span>
git subtree pull <span class="nt">--prefix</span><span class="o">=</span>lib/core https://github.com/org/lib.git master

<span class="c"># Push changes back to subtree remote</span>
git subtree push <span class="nt">--prefix</span><span class="o">=</span>lib/core https://github.com/org/lib.git master
</code></pre></div></div> <h3 id="debugging-git-issues">Debugging Git Issues</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Debug git commands</span>
<span class="nv">GIT_TRACE</span><span class="o">=</span>1 git push origin master

<span class="c"># Debug specific areas</span>
<span class="nv">GIT_TRACE_PACKET</span><span class="o">=</span>1  <span class="c"># Network operations</span>
<span class="nv">GIT_TRACE_PERFORMANCE</span><span class="o">=</span>1  <span class="c"># Performance data</span>
<span class="nv">GIT_TRACE_SETUP</span><span class="o">=</span>1  <span class="c"># Setup info</span>

<span class="c"># Find large files in history</span>
git rev-list <span class="nt">--objects</span> <span class="nt">--all</span> <span class="se">\</span>
  | git cat-file <span class="nt">--batch-check</span><span class="o">=</span><span class="s1">'%(objecttype) %(objectname) %(objectsize) %(rest)'</span> <span class="se">\</span>
  | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s/^blob //p'</span> <span class="se">\</span>
  | <span class="nb">sort</span> <span class="nt">-k2nr</span> <span class="se">\</span>
  | <span class="nb">head</span> <span class="nt">-10</span>
</code></pre></div></div> <h2 id="useful-resources">Useful Resources</h2> <ul> <li><a href="https://git-scm.com/doc" target="_blank" rel="noopener noreferrer">Git Documentation</a></li> <li><a href="https://cli.github.com/manual/" target="_blank" rel="noopener noreferrer">GitHub CLI Manual</a></li> <li><a href="https://pre-commit.com/" target="_blank" rel="noopener noreferrer">Pre-commit Framework</a></li> <li><a href="https://www.conventionalcommits.org/" target="_blank" rel="noopener noreferrer">Conventional Commits</a></li> <li><a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener noreferrer">Git Flow</a></li> <li><a href="https://git-scm.com/book/en/v2/Git-Internals-Plumbing-and-Porcelain" target="_blank" rel="noopener noreferrer">Git Internal Files</a></li> <li><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration" target="_blank" rel="noopener noreferrer">Advanced Git Configuration</a></li> <li><a href="https://git-scm.com/docs/gitattributes" target="_blank" rel="noopener noreferrer">Git Attributes</a></li> <li><a href="https://git-scm.com/book/en/v2/Git-Internals-Plumbing-and-Porcelain" target="_blank" rel="noopener noreferrer">Git Plumbing Commands</a></li> </ul> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2025 Nasib A. Naimi. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Last updated: June 17, 2025. </div> </footer> <d-bibliography src="/assets/bibliography/"></d-bibliography> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-YX1MHD2T9S"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-YX1MHD2T9S");</script> </body> </html>